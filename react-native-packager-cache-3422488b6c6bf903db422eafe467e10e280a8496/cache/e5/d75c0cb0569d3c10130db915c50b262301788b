Object.defineProperty(exports, "__esModule", {
    value: true
});
var _jsxFileName = '/home/jarek/battleCraftSound/battleCraftMobile/App/components/account/NoAuthPanel/RegisterPopup/tabs/ResendMailTab.js';

var _react = require('react');

var _react2 = babelHelpers.interopRequireDefault(_react);

var _reactNative = require('react-native');

var _reactNativeFormGenerator = require('react-native-form-generator');

var _ValidationErrorMessage = require('../../../../entityPanel/outputs/ValidationErrorMessage');

var _ValidationErrorMessage2 = babelHelpers.interopRequireDefault(_ValidationErrorMessage);

var _EntityPanelStyle = require('../../../../../Styles/CollectionPanelStyles/EntityPanelStyle');

var _EntityPanelStyle2 = babelHelpers.interopRequireDefault(_EntityPanelStyle);

var _MainStyles = require('../../../../../Styles/UniversalStyles/MainStyles');

var _MainStyles2 = babelHelpers.interopRequireDefault(_MainStyles);

var _InputStyles = require('../../../../../Styles/UniversalStyles/InputStyles');

var _InputStyles2 = babelHelpers.interopRequireDefault(_InputStyles);

var _EntityPanelInputsStyles = require('../../../../../Styles/CollectionPanelStyles/EntityPanelInputsStyles');

var _EntityPanelInputsStyles2 = babelHelpers.interopRequireDefault(_EntityPanelInputsStyles);

var _index = require('../../../../../redux/actions/index');

var _redux = require('redux');

var _reactRedux = require('react-redux');

var _BaseColours = require('../../../../../main/consts/BaseColours');

var _BaseColours2 = babelHelpers.interopRequireDefault(_BaseColours);

var _serverName = require('../../../../../main/consts/serverName');

var _axios = require('axios');

var _axios2 = babelHelpers.interopRequireDefault(_axios);

var ResendMailTab = function (_Component) {
    babelHelpers.inherits(ResendMailTab, _Component);

    function ResendMailTab(props) {
        babelHelpers.classCallCheck(this, ResendMailTab);

        var _this = babelHelpers.possibleConstructorReturn(this, (ResendMailTab.__proto__ || Object.getPrototypeOf(ResendMailTab)).call(this, props));

        _this.state = {
            value: "",
            validationError: ""
        };
        return _this;
    }

    babelHelpers.createClass(ResendMailTab, [{
        key: 'resendMail',
        value: function resendMail() {
            var _this2 = this;

            if (this.state.validationError !== "") this.setState({ validationError: "" });

            if (!this.state.value.match(new RegExp("(^[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\\.+[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@+(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?$)"))) {
                this.setState({ validationError: "Invalid email" });
                return;
            }

            var resendTokenOperation = function resendTokenOperation() {
                _this2.props.startLoading("Resending email...");
                _axios2.default.post(_serverName.serverName + "registration/resendToken", { email: _this2.state.value }).then(function (res) {
                    _this2.props.stopLoading();
                    _this2.props.showSuccessMessage("Verification email resubmitted. Please check your mail box.");
                    _this2.props.disable();
                }).catch(function (error) {
                    _this2.props.stopLoading();
                    _this2.props.showNetworkErrorMessage(error, resendTokenOperation);
                });
            };

            resendTokenOperation();
        }
    }, {
        key: 'calculateHeight',
        value: function calculateHeight() {
            return this.props.orientation === 'portrait' ? this.props.height * 0.85 - 190 : this.props.height * 0.77 - 150;
        }
    }, {
        key: 'render',
        value: function render() {
            var _this3 = this;

            var height = this.calculateHeight();
            return _react2.default.createElement(
                _reactNative.ScrollView,
                {
                    style: { height: height },
                    contentContainerStyle: _EntityPanelStyle2.default.scrollView, __source: {
                        fileName: _jsxFileName,
                        lineNumber: 74
                    }
                },
                _react2.default.createElement(
                    _reactNative.View,
                    { style: _InputStyles2.default.inputCard, __source: {
                            fileName: _jsxFileName,
                            lineNumber: 78
                        }
                    },
                    _react2.default.createElement(
                        _reactNative.View,
                        { style: _InputStyles2.default.inputText, __source: {
                                fileName: _jsxFileName,
                                lineNumber: 79
                            }
                        },
                        _react2.default.createElement(
                            _reactNative.Text,
                            { style: [_MainStyles2.default.smallWhiteStyle, { fontWeight: 'bold' }], __source: {
                                    fileName: _jsxFileName,
                                    lineNumber: 79
                                }
                            },
                            'E-mail:'
                        )
                    ),
                    _react2.default.createElement(
                        _reactNative.View,
                        { style: _EntityPanelInputsStyles2.default.inputStyle, __source: {
                                fileName: _jsxFileName,
                                lineNumber: 80
                            }
                        },
                        _react2.default.createElement(
                            _reactNative.Text,
                            {
                                __source: {
                                    fileName: _jsxFileName,
                                    lineNumber: 81
                                }
                            },
                            'E-mail:'
                        ),
                        _react2.default.createElement(_reactNativeFormGenerator.InputField, {
                            onValueChange: function onValueChange(value) {
                                _this3.setState({ value: value });
                            },
                            value: this.state.value,
                            placeholder: 'jarek123@gmail.com',
                            __source: {
                                fileName: _jsxFileName,
                                lineNumber: 82
                            }
                        })
                    ),
                    _react2.default.createElement(_ValidationErrorMessage2.default, {
                        validationErrorMessage: this.state.validationError, __source: {
                            fileName: _jsxFileName,
                            lineNumber: 88
                        }
                    })
                ),
                _react2.default.createElement(
                    _reactNative.TouchableHighlight,
                    { style: [_EntityPanelStyle2.default.button, { backgroundColor: _BaseColours2.default.background.darkBrown }],
                        onPress: function onPress() {
                            _this3.resendMail();
                        }, __source: {
                            fileName: _jsxFileName,
                            lineNumber: 92
                        }
                    },
                    _react2.default.createElement(
                        _reactNative.Text,
                        { style: [_MainStyles2.default.smallWhiteStyle, { fontWeight: 'bold' }], __source: {
                                fileName: _jsxFileName,
                                lineNumber: 94
                            }
                        },
                        'Resend'
                    )
                )
            );
        }
    }]);
    return ResendMailTab;
}(_react.Component);

function mapDispatchToProps(dispatch) {
    return (0, _redux.bindActionCreators)(_index.ActionCreators, dispatch);
}

function mapStateToProps(state) {
    return {};
}

exports.default = (0, _reactRedux.connect)(mapStateToProps, mapDispatchToProps)(ResendMailTab);